{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizer Dashboard - EventFlex</title>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}?v=1.7">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="dashboard-page" data-requires-auth="true" data-user-type="organizer">
    <!-- Dashboard Navigation -->
    <nav class="dashboard-nav">
        <div class="nav-brand">
            <i class="fas fa-calendar-check"></i>
            <span>EventFlex</span>
        </div>
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/#features">Features</a>
            <a href="/#how-it-works">How It Works</a>
        </div>
        <div class="nav-user">
            <span class="nav-link-text">Login</span>
            <a href="{% url 'signup_page' %}" class="btn-primary-small">Sign Up</a>
            <div class="user-profile">
                <img src="https://ui-avatars.com/api/?name=Test&background=6366f1&color=fff" alt="Profile"
                    id="user-avatar">
                <span id="user-name-display">Test</span>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <ul class="sidebar-menu">
                <li class="active">
                    <a href="#dashboard"><i class="fas fa-home"></i> Dashboard</a>
                </li>
                <li>
                    <a href="#post-job"><i class="fas fa-plus-circle"></i> Post a Job</a>
                </li>
                <li>
                    <a href="#discover"><i class="fas fa-search"></i> Discover Talent</a>
                </li>
                <li>
                    <a href="#my-jobs"><i class="fas fa-briefcase"></i> My Events</a>
                </li>
                <li>
                    <a href="#payments"><i class="fas fa-wallet"></i> Payments</a>
                </li>
                <li>
                    <a href="#messages"><i class="fas fa-comments"></i> Messages</a>
                </li>
                <li>
                    <a href="#profile"><i class="fas fa-user"></i> Profile</a>
                </li>
                <li>
                    <a href="{% url 'home' %}" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Dashboard Overview -->
            <section id="dashboard" class="dashboard-section active">
                <h1>Welcome back! ðŸ‘‹</h1>
                <p class="subtitle">Here's what's happening with your events today</p>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">
                            <i class="fas fa-briefcase"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-active-jobs">0</h3>
                            <p>Active Jobs</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-hired-staff">0</h3>
                            <p>Hired Staff</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-upcoming-events">0</h3>
                            <p>Upcoming Events</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon purple">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-total-spent">â‚¹0</h3>
                            <p>Total Spent</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h2>Upcoming Events</h2>
                            <a href="#my-jobs" class="view-all">View All</a>
                        </div>
                        <div class="event-list" id="upcoming-events-list">
                            <p class="empty-state">Loading upcoming events...</p>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h2>Recent Applications</h2>
                            <a href="#discover" class="view-all">View All</a>
                        </div>
                        <div class="application-list" id="recent-applications-list">
                            <p class="empty-state">Loading applications...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Post a Job Section -->
            <section id="post-job" class="dashboard-section">
                <h1>Post a New Job</h1>
                <p class="subtitle">Fill in the details to find the perfect staff for your event</p>

                <div class="form-card">
                    <form id="jobPostForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Event Title *</label>
                                <input type="text" name="title" placeholder="e.g., Tech Conference 2025" required>
                            </div>
                            <div class="form-group">
                                <label>Event Type *</label>
                                <input type="text" name="event_type" list="event-type-suggestions"
                                    placeholder="Select or type event type" required>
                                <datalist id="event-type-suggestions">
                                    <option value="Event Staffing">
                                    <option value="Conference">
                                    <option value="Wedding">
                                    <option value="Corporate Event">
                                    <option value="Festival">
                                    <option value="Concert">
                                    <option value="Exhibition">
                                    <option value="Workshop">
                                    <option value="Seminar">
                                </datalist>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Role/Position *</label>
                                <input type="text" name="role" list="role-suggestions"
                                    placeholder="e.g., Registration Desk Staff" required>
                                <datalist id="role-suggestions">
                                    <!-- Dynamic suggestions will be populated here -->
                                </datalist>
                            </div>
                            <div class="form-group">
                                <label>Number of Staff Needed *</label>
                                <input type="number" name="number_of_staff" placeholder="e.g., 5" min="1" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Skills Required</label>
                            <div class="skill-tags">
                                <span class="skill-tag">Communication <i class="fas fa-times"></i></span>
                                <span class="skill-tag">Customer Service <i class="fas fa-times"></i></span>
                                <input type="text" id="skillInput" list="skill-suggestions" placeholder="Add skills...">
                                <datalist id="skill-suggestions">
                                    <!-- Dynamic suggestions will be populated here -->
                                </datalist>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Event Date *</label>
                                <input type="date" name="date" required>
                            </div>
                            <div class="form-group">
                                <label>Start Time *</label>
                                <input type="time" name="start_time" required>
                            </div>
                            <div class="form-group">
                                <label>End Time *</label>
                                <input type="time" name="end_time" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Location *</label>
                            <div class="location-input-wrapper" style="position: relative;">
                                <i class="fas fa-map-marker-alt"></i>
                                <input type="text" name="location" id="job-location-input" list="location-suggestions"
                                    placeholder="Enter city or venue address (e.g., Mumbai, Bangalore Convention Center)"
                                    required>
                                <button type="button" id="get-current-location-btn" class="current-location-btn"
                                    title="Use my current location">
                                    <i class="fas fa-crosshairs"></i> Current Location
                                </button>
                                <datalist id="location-suggestions">
                                    <!-- Dynamic suggestions will be populated here -->
                                </datalist>
                            </div>
                            <small class="form-hint">Enter the city or full venue address where the event will take
                                place, or use your current location</small>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Pay Rate (per person) *</label>
                                <input type="number" name="pay_rate" placeholder="â‚¹ 2000" min="0" required>
                            </div>
                            <div class="form-group">
                                <label>Payment Type *</label>
                                <select name="payment_type" required>
                                    <option value="hourly">Per Hour</option>
                                    <option value="daily">Per Day</option>
                                    <option value="event">Per Event</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Job Description *</label>
                            <textarea name="description" rows="5"
                                placeholder="Describe the role, responsibilities, and requirements..."
                                required></textarea>
                        </div>

                        <div class="form-group">
                            <label>Requirements & Preferences</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="requirements" value="experience"> Experience
                                    Required (1+ years)</label>
                                <label><input type="checkbox" name="requirements" value="kyc"> KYC Verified Only</label>
                                <label><input type="checkbox" name="requirements" value="video"> Video Intro
                                    Required</label>
                                <label><input type="checkbox" name="requirements" value="badge"> Elite/Pro Badge
                                    Preferred</label>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" id="saveDraftBtn" class="btn-outline">Save as Draft</button>
                            <button type="submit" class="btn-primary">Post Job</button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Discover Talent Section -->
            <section id="discover" class="dashboard-section">
                <h1>Discover Talent</h1>
                <p class="subtitle">Find pre-vetted professionals for your events</p>

                <div class="search-filters">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" id="talent-search-input"
                            placeholder="Search by name, skills, or location...">
                    </div>
                    <div class="filter-group">
                        <div class="filter-input-wrapper">
                            <i class="fas fa-map-marker-alt"></i>
                            <input type="text" id="filter-talent-location" placeholder="Enter location">
                        </div>
                        <select id="filter-talent-skills">
                            <option value="">All Skills</option>
                            <option value="coordination">Event Coordination</option>
                            <option value="registration">Registration</option>
                            <option value="hospitality">Hospitality</option>
                            <option value="tech">Technical Support</option>
                        </select>
                        <select id="filter-talent-rating">
                            <option value="">All Ratings</option>
                            <option value="5">5 Stars</option>
                            <option value="4">4+ Stars</option>
                            <option value="3">3+ Stars</option>
                        </select>
                        <select id="filter-talent-badge">
                            <option value="">All Badges</option>
                            <option value="Elite Pro">Elite Pro</option>
                            <option value="Pro">Pro</option>
                            <option value="Rising Star">Rising Star</option>
                        </select>
                    </div>
                </div>

                <div class="talent-grid" id="talent-grid-organizer">
                    <p class="empty-state">Loading talent profiles...</p>
                </div>
            </section>

            <!-- My Jobs Section -->
            <section id="my-jobs" class="dashboard-section">
                <h1>My Jobs</h1>
                <div class="tabs-secondary">
                    <button class="tab-btn-secondary active" data-tab="active-jobs">Active</button>
                    <button class="tab-btn-secondary" data-tab="completed-jobs">Completed</button>
                    <button class="tab-btn-secondary" data-tab="draft-jobs">Drafts</button>
                </div>

                <div class="jobs-list" data-tab-content="active-jobs">
                    <p class="empty-state">Loading active jobs...</p>
                </div>

                <div class="jobs-list" data-tab-content="completed-jobs" style="display: none;">
                    <p class="empty-state">Loading completed jobs...</p>
                </div>

                <div class="jobs-list" data-tab-content="draft-jobs" style="display: none;">
                    <p class="empty-state">Loading draft jobs...</p>
                </div>
            </section>

            <!-- Payments Section -->
            <section id="payments" class="dashboard-section">
                <h1>Payments & Billing</h1>

                <div class="payment-overview">
                    <div class="payment-card">
                        <h3>Account Balance</h3>
                        <p class="amount" id="organizer-wallet-balance">â‚¹0</p>
                        <button class="btn-primary" onclick="showAddFundsModal()">Add Funds</button>
                    </div>
                    <div class="payment-card">
                        <h3>Pending Payments</h3>
                        <p class="amount" id="organizer-pending-payments">â‚¹0</p>
                        <button class="btn-outline" onclick="showPendingPaymentsModal()">View Details</button>
                    </div>
                    <div class="payment-card">
                        <h3>Total Released</h3>
                        <p class="amount" id="organizer-total-released">â‚¹0</p>
                        <button class="btn-outline" onclick="showReleasedPaymentsModal()">Release History</button>
                    </div>
                </div>
            </section>

            <!-- Messages Section -->
            <section id="messages" class="dashboard-section">
                <h1>Messages</h1>
                <div class="messages-container">
                    <div class="messages-sidebar">
                        <div class="message-search">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="Search conversations...">
                        </div>
                        <div class="conversation-list">
                            <div class="conversation-item active">
                                <img src="https://ui-avatars.com/api/?name=Priya+Kumar&background=6366f1&color=fff"
                                    alt="Priya Kumar">
                                <div class="conversation-info">
                                    <h4>Priya Kumar</h4>
                                    <p>Thanks! See you at the event...</p>
                                </div>
                                <span class="time">2m</span>
                            </div>
                            <div class="conversation-item">
                                <img src="https://ui-avatars.com/api/?name=Rahul+Singh&background=10b981&color=fff"
                                    alt="Rahul Singh">
                                <div class="conversation-info">
                                    <h4>Rahul Singh</h4>
                                    <p>What time should I arrive?</p>
                                </div>
                                <span class="time">1h</span>
                            </div>
                        </div>
                    </div>
                    <div class="chat-area">
                        <div class="chat-header">
                            <img src="https://ui-avatars.com/api/?name=Priya+Kumar&background=6366f1&color=fff"
                                alt="Priya Kumar">
                            <div>
                                <h4>Priya Kumar</h4>
                                <p>Active now</p>
                            </div>
                        </div>
                        <div class="chat-messages">
                            <div class="message received">
                                <p>Hi! I applied for the Event Coordinator position.</p>
                                <span class="time">10:30 AM</span>
                            </div>
                            <div class="message sent">
                                <p>Great! I've reviewed your profile. You're hired!</p>
                                <span class="time">10:35 AM</span>
                            </div>
                            <div class="message received">
                                <p>Thanks! See you at the event on Nov 15th.</p>
                                <span class="time">10:37 AM</span>
                            </div>
                        </div>
                        <div class="chat-input">
                            <input type="text" placeholder="Type a message...">
                            <button class="btn-primary"><i class="fas fa-paper-plane"></i></button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile" class="dashboard-section">
                <h1>Profile Settings</h1>
                <div class="profile-card">
                    <div class="profile-header">
                        <img src="https://ui-avatars.com/api/?name=Event+Organizer&background=6366f1&color=fff"
                            alt="Profile" class="profile-image-large" id="organizer-profile-image">
                        <div class="profile-header-info">
                            <h2>Event Organizer</h2>
                            <p class="profile-role">Event Organizer</p>
                        </div>
                        <input type="file" id="organizer-photo-input" accept="image/*" style="display: none;">
                        <button class="btn-outline"
                            onclick="document.getElementById('organizer-photo-input').click()">Change Photo</button>
                    </div>
                    <form class="profile-form" onsubmit="handleProfileSave(event)" id="profile-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Company/Organization Name</label>
                                <input type="text" name="username" value="TechEvents India">
                            </div>
                            <div class="form-group">
                                <label>Contact Person</label>
                                <input type="text" name="first_name" value="Amit Sharma">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" name="email" value="amit@techevents.in" readonly>
                            </div>
                            <div class="form-group">
                                <label>Phone</label>
                                <input type="tel" name="phone" value="+91 98765 43210">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>City</label>
                            <select name="city">
                                <option value="">Select your city</option>
                                <!-- Metro Cities -->
                                <option value="Mumbai">Mumbai</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Bangalore">Bangalore</option>
                                <option value="Hyderabad">Hyderabad</option>
                                <option value="Ahmedabad">Ahmedabad</option>
                                <option value="Chennai">Chennai</option>
                                <option value="Kolkata">Kolkata</option>
                                <option value="Pune">Pune</option>
                                <!-- Tier 1 Cities -->
                                <option value="Surat">Surat</option>
                                <option value="Jaipur">Jaipur</option>
                                <option value="Lucknow">Lucknow</option>
                                <option value="Kanpur">Kanpur</option>
                                <option value="Nagpur">Nagpur</option>
                                <option value="Indore">Indore</option>
                                <option value="Thane">Thane</option>
                                <option value="Bhopal">Bhopal</option>
                                <option value="Visakhapatnam">Visakhapatnam</option>
                                <option value="Pimpri-Chinchwad">Pimpri-Chinchwad</option>
                                <option value="Patna">Patna</option>
                                <option value="Vadodara">Vadodara</option>
                                <option value="Ghaziabad">Ghaziabad</option>
                                <option value="Ludhiana">Ludhiana</option>
                                <option value="Agra">Agra</option>
                                <option value="Nashik">Nashik</option>
                                <option value="Faridabad">Faridabad</option>
                                <option value="Meerut">Meerut</option>
                                <option value="Rajkot">Rajkot</option>
                                <option value="Kalyan-Dombivali">Kalyan-Dombivali</option>
                                <option value="Vasai-Virar">Vasai-Virar</option>
                                <option value="Varanasi">Varanasi</option>
                                <option value="Srinagar">Srinagar</option>
                                <option value="Aurangabad">Aurangabad</option>
                                <option value="Dhanbad">Dhanbad</option>
                                <option value="Amritsar">Amritsar</option>
                                <option value="Navi Mumbai">Navi Mumbai</option>
                                <option value="Allahabad">Allahabad (Prayagraj)</option>
                                <option value="Ranchi">Ranchi</option>
                                <option value="Howrah">Howrah</option>
                                <option value="Coimbatore">Coimbatore</option>
                                <option value="Jabalpur">Jabalpur</option>
                                <option value="Gwalior">Gwalior</option>
                                <option value="Vijayawada">Vijayawada</option>
                                <option value="Jodhpur">Jodhpur</option>
                                <option value="Madurai">Madurai</option>
                                <option value="Raipur">Raipur</option>
                                <option value="Kota">Kota</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Guwahati">Guwahati</option>
                                <option value="Solapur">Solapur</option>
                                <option value="Hubli-Dharwad">Hubli-Dharwad</option>
                                <option value="Mysore">Mysore</option>
                                <option value="Tiruchirappalli">Tiruchirappalli</option>
                                <option value="Bareilly">Bareilly</option>
                                <option value="Aligarh">Aligarh</option>
                                <option value="Tiruppur">Tiruppur</option>
                                <option value="Gurgaon">Gurgaon</option>
                                <option value="Moradabad">Moradabad</option>
                                <option value="Jalandhar">Jalandhar</option>
                                <option value="Bhubaneswar">Bhubaneswar</option>
                                <option value="Salem">Salem</option>
                                <option value="Warangal">Warangal</option>
                                <option value="Mira-Bhayandar">Mira-Bhayandar</option>
                                <option value="Thiruvananthapuram">Thiruvananthapuram</option>
                                <option value="Bhiwandi">Bhiwandi</option>
                                <option value="Saharanpur">Saharanpur</option>
                                <option value="Guntur">Guntur</option>
                                <option value="Amravati">Amravati</option>
                                <option value="Bikaner">Bikaner</option>
                                <option value="Noida">Noida</option>
                                <option value="Jamshedpur">Jamshedpur</option>
                                <option value="Bhilai">Bhilai</option>
                                <option value="Cuttack">Cuttack</option>
                                <option value="Firozabad">Firozabad</option>
                                <option value="Kochi">Kochi</option>
                                <option value="Nellore">Nellore</option>
                                <option value="Bhavnagar">Bhavnagar</option>
                                <option value="Dehradun">Dehradun</option>
                                <option value="Durgapur">Durgapur</option>
                                <option value="Asansol">Asansol</option>
                                <option value="Rourkela">Rourkela</option>
                                <option value="Nanded">Nanded</option>
                                <option value="Kolhapur">Kolhapur</option>
                                <option value="Ajmer">Ajmer</option>
                                <option value="Akola">Akola</option>
                                <option value="Gulbarga">Gulbarga</option>
                                <option value="Jamnagar">Jamnagar</option>
                                <option value="Ujjain">Ujjain</option>
                                <option value="Loni">Loni</option>
                                <option value="Siliguri">Siliguri</option>
                                <option value="Jhansi">Jhansi</option>
                                <option value="Ulhasnagar">Ulhasnagar</option>
                                <option value="Jammu">Jammu</option>
                                <option value="Sangli-Miraj">Sangli-Miraj</option>
                                <option value="Mangalore">Mangalore</option>
                                <option value="Erode">Erode</option>
                                <option value="Belgaum">Belgaum</option>
                                <option value="Ambattur">Ambattur</option>
                                <option value="Tirunelveli">Tirunelveli</option>
                                <option value="Malegaon">Malegaon</option>
                                <option value="Gaya">Gaya</option>
                                <option value="Jalgaon">Jalgaon</option>
                                <option value="Udaipur">Udaipur</option>
                                <option value="Maheshtala">Maheshtala</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>About Organization</label>
                            <textarea name="bio"
                                rows="4">Leading event management company specializing in corporate and tech events.</textarea>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn-outline">Cancel</button>
                            <button type="submit" class="btn-primary">Save Changes</button>
                        </div>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <!-- Add Funds Modal -->
    <div id="add-funds-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAddFundsModal()">&times;</span>
            <h2>Add Funds to Wallet</h2>
            <form onsubmit="handleAddFunds(event)">
                <div class="form-group">
                    <label>Amount to Add</label>
                    <input type="number" id="add-funds-amount" placeholder="Enter amount" required min="100">
                </div>
                <div class="form-group">
                    <label>Payment Method</label>
                    <select required>
                        <option value="card">Credit/Debit Card</option>
                        <option value="upi">UPI</option>
                        <option value="netbanking">Net Banking</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-outline" onclick="closeAddFundsModal()">Cancel</button>
                    <button type="submit" class="btn-primary">Add Funds</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Pending Payments Modal -->
    <div id="pending-payments-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close-modal" onclick="closePendingPaymentsModal()">&times;</span>
            <h2>Pending Payments</h2>
            <p style="color: #666; margin-bottom: 1.5rem;">Staff hired for active events. Payments will be released when
                events are marked as finished.</p>
            <div id="pending-payments-list" style="max-height: 500px; overflow-y: auto;">
                <!-- Pending payments will be loaded here -->
            </div>
            <div class="form-actions" style="margin-top: 1.5rem;">
                <button class="btn-primary" onclick="closePendingPaymentsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Released Payments Modal -->
    <div id="released-payments-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close-modal" onclick="closeReleasedPaymentsModal()">&times;</span>
            <h2>Released Payments History</h2>
            <p style="color: #666; margin-bottom: 1.5rem;">All payments released to staff for completed events.</p>
            <div id="released-payments-list" style="max-height: 500px; overflow-y: auto;">
                <!-- Released payments will be loaded here -->
            </div>
            <div class="form-actions" style="margin-top: 1.5rem;">
                <button class="btn-primary" onclick="closeReleasedPaymentsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Track Attendance Modal -->
    <div id="attendance-modal" class="modal" style="display: none;">
        <div class="modal-content qr-modal-content">
            <span class="close-modal" onclick="closeAttendanceModal()">&times;</span>
            <h2>Track Attendance</h2>
            <p class="qr-instructions">Share this QR code with your staff for attendance tracking</p>
            <div id="attendance-qr-container"></div>
            <div class="qr-booking-info">
                <h3 id="attendance-job-title"></h3>
                <p id="attendance-job-details"></p>
            </div>
            <button class="btn-primary" onclick="closeAttendanceModal()">Close</button>
        </div>
    </div>

    <!-- Report Modal -->
    <div id="report-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal" onclick="closeReportModal()">&times;</span>
            <h2>Job Report</h2>
            <div id="report-content">
                <!-- Report content will be loaded here -->
            </div>
            <div class="form-actions">
                <button class="btn-outline" onclick="downloadReportPDF()">Download PDF</button>
                <button class="btn-primary" onclick="closeReportModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Application Detail Modal -->
    <div id="application-detail-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
            <span class="close-modal" onclick="closeApplicationDetailModal()">&times;</span>
            <h2 style="margin-bottom: 1.5rem; color: var(--gold);">
                <i class="fas fa-file-alt"></i> Application Details
            </h2>

            <div id="application-detail-content">
                <!-- Header Section -->
                <div class="application-header"
                    style="background: rgba(218, 165, 32, 0.1); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 1rem;">
                        <div>
                            <h3 id="applicant-name" style="font-size: 1.5rem; margin-bottom: 0.5rem;"></h3>
                            <p id="application-job-title" style="color: var(--gold); font-size: 1.1rem;"></p>
                        </div>
                        <div>
                            <span id="application-status-badge" class="badge"
                                style="padding: 0.5rem 1rem; font-size: 1rem;"></span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; display: flex; gap: 2rem; flex-wrap: wrap;">
                        <div>
                            <i class="fas fa-envelope"></i> <span id="applicant-email"></span>
                        </div>
                        <div>
                            <i class="fas fa-phone"></i> <span id="applicant-phone"></span>
                        </div>
                        <div>
                            <i class="fas fa-calendar"></i> Applied: <span id="application-date"></span>
                        </div>
                    </div>
                </div>

                <!-- AI Rating Section -->
                <div class="detail-section" id="ai-rating-section"
                    style="margin-bottom: 2rem; background: linear-gradient(135deg, rgba(218, 165, 32, 0.15) 0%, rgba(184, 134, 11, 0.1) 100%); padding: 1.5rem; border-radius: 8px; border-left: 4px solid var(--gold);">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-robot"></i> AI Application Rating
                    </h3>
                    <div style="display: flex; align-items: center; gap: 2rem; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div id="ai-rating-stars" style="font-size: 2rem; color: #FFD700;"></div>
                            <div style="font-size: 2.5rem; font-weight: bold; color: var(--gold);" id="ai-rating-score">
                            </div>
                        </div>
                        <div style="flex: 1; min-width: 200px;">
                            <div id="ai-rating-details"
                                style="white-space: pre-wrap; line-height: 1.8; font-size: 0.95rem; background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 6px;">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Professional Info Section -->
                <div class="detail-section" style="margin-bottom: 2rem;">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-user-tie"></i> Professional Information
                    </h3>
                    <div class="detail-grid"
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
                        <div class="detail-item">
                            <strong style="color: #ccc; display: block; margin-bottom: 0.5rem;">Experience:</strong>
                            <span id="applicant-experience"></span> years
                        </div>
                        <div class="detail-item">
                            <strong style="color: #ccc; display: block; margin-bottom: 0.5rem;">Expected
                                Compensation:</strong>
                            <span id="applicant-compensation"></span>
                        </div>
                    </div>
                </div>

                <!-- Skills Section -->
                <div class="detail-section" style="margin-bottom: 2rem;">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-tools"></i> Skills & Expertise
                    </h3>
                    <div id="applicant-skills" style="white-space: pre-wrap; line-height: 1.6;"></div>
                </div>

                <!-- Availability Section -->
                <div class="detail-section" style="margin-bottom: 2rem;">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-clock"></i> Availability
                    </h3>
                    <div id="applicant-availability" style="white-space: pre-wrap; line-height: 1.6;"></div>
                </div>

                <!-- Portfolio Section -->
                <div class="detail-section" style="margin-bottom: 2rem;" id="portfolio-section">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-link"></i> Portfolio
                    </h3>
                    <a id="applicant-portfolio" href="#" target="_blank"
                        style="color: var(--gold); text-decoration: none;">
                        <i class="fas fa-external-link-alt"></i> View Portfolio
                    </a>
                </div>

                <!-- Resume/CV Section -->
                <div class="detail-section" style="margin-bottom: 2rem;" id="resume-section">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-file-pdf"></i> Resume / CV
                    </h3>
                    <a id="applicant-resume" href="#" target="_blank"
                        style="display: inline-flex; align-items: center; gap: 0.5rem; color: var(--gold); text-decoration: none; background: rgba(218, 165, 32, 0.1); padding: 0.75rem 1rem; border-radius: 6px; transition: all 0.3s ease;">
                        <i class="fas fa-download"></i> <span id="resume-filename">Download Resume</span>
                    </a>
                </div>

                <!-- Previous Experience Section -->
                <div class="detail-section" style="margin-bottom: 2rem;">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-history"></i> Previous Events & Experience
                    </h3>
                    <div id="applicant-previous-events" style="white-space: pre-wrap; line-height: 1.6;"></div>
                </div>

                <!-- Why Interested Section -->
                <div class="detail-section" style="margin-bottom: 2rem;">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-comment-dots"></i> Why Interested
                    </h3>
                    <div id="applicant-why-interested" style="white-space: pre-wrap; line-height: 1.6;"></div>
                </div>

                <!-- Cover Message Section -->
                <div class="detail-section" style="margin-bottom: 2rem;" id="cover-message-section">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-envelope-open-text"></i> Cover Message
                    </h3>
                    <div id="applicant-cover-message"
                        style="white-space: pre-wrap; line-height: 1.6; font-style: italic;"></div>
                </div>

                <!-- Action Buttons (only show if pending) -->
                <div id="application-actions" class="modal-actions"
                    style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end; padding-top: 1.5rem; border-top: 2px solid rgba(218, 165, 32, 0.3);">
                    <button type="button" class="btn-outline" onclick="closeApplicationDetailModal()">Close</button>
                    <button type="button" class="btn-outline" style="background: #dc3545; border-color: #dc3545;"
                        onclick="handleRejectApplication()">
                        <i class="fas fa-times-circle"></i> Reject
                    </button>
                    <button type="button" class="btn-primary" onclick="handleAcceptApplication()">
                        <i class="fas fa-check-circle"></i> Accept Application
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Details Modal -->
    <div id="event-details-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <span class="close-modal" onclick="closeEventDetailsModal()">&times;</span>
            <h2 style="margin-bottom: 1.5rem; color: var(--gold);">
                <i class="fas fa-briefcase"></i> Event Details
            </h2>

            <div id="job-details-content">
                <!-- Event Information Section -->
                <div class="detail-section"
                    style="background: rgba(218, 165, 32, 0.1); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <h3 id="event-detail-title" style="font-size: 1.5rem; margin-bottom: 0.5rem;"></h3>
                            <p id="event-detail-type" style="color: var(--gold); font-size: 1.1rem;"></p>
                        </div>
                        <span id="event-detail-status" class="status-badge"></span>
                    </div>

                    <div class="detail-grid"
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <div>
                            <i class="fas fa-map-marker-alt"></i> <strong>Location:</strong><br>
                            <span id="event-detail-location"></span>
                        </div>
                        <div>
                            <i class="fas fa-calendar"></i> <strong>Date:</strong><br>
                            <span id="event-detail-date"></span>
                        </div>
                        <div>
                            <i class="fas fa-clock"></i> <strong>Time:</strong><br>
                            <span id="event-detail-time"></span>
                        </div>
                        <div>
                            <i class="fas fa-users"></i> <strong>Staff Needed:</strong><br>
                            <span id="event-detail-staff-needed"></span>
                        </div>
                        <div>
                            <i class="fas fa-money-bill-wave"></i> <strong>Pay Rate:</strong><br>
                            <span id="event-detail-pay"></span>
                        </div>
                        <div>
                            <i class="fas fa-user-tie"></i> <strong>Role:</strong><br>
                            <span id="event-detail-role"></span>
                        </div>
                    </div>
                </div>

                <!-- Event Description Section -->
                <div class="detail-section" style="margin-bottom: 2rem;">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-info-circle"></i> Description
                    </h3>
                    <p id="event-detail-description" style="line-height: 1.6; white-space: pre-wrap;"></p>
                </div>

                <!-- Requirements & Skills -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                    <div class="detail-section">
                        <h3
                            style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                            <i class="fas fa-clipboard-check"></i> Requirements
                        </h3>
                        <p id="event-detail-requirements" style="line-height: 1.6;"></p>
                    </div>
                    <div class="detail-section">
                        <h3
                            style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                            <i class="fas fa-star"></i> Required Skills
                        </h3>
                        <p id="event-detail-skills" style="line-height: 1.6;"></p>
                    </div>
                </div>

                <!-- Hired Staff Section -->
                <div class="detail-section" style="margin-bottom: 2rem;">
                    <h3
                        style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--gold); border-bottom: 2px solid var(--gold); padding-bottom: 0.5rem;">
                        <i class="fas fa-user-check"></i> Hired Staff (<span id="hired-staff-count">0</span>)
                    </h3>
                    <div id="hired-staff-list" style="display: flex; flex-direction: column; gap: 1rem;">
                        <!-- Staff cards will be populated here -->
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="modal-actions"
                    style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end; padding-top: 1.5rem; border-top: 2px solid rgba(218, 165, 32, 0.3);">
                    <button type="button" class="btn-outline" onclick="closeEventDetailsModal()">Close</button>
                    <button type="button" id="finish-event-btn" class="btn-primary"
                        style="background: #10b981; border-color: #10b981;" onclick="handleFinishEvent()">
                        <i class="fas fa-check-circle"></i> Finish Event
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Rate Staff Modal -->
    <div id="review-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close-modal" onclick="closeReviewModal()">&times;</span>
            <h2 style="margin-bottom: 1.5rem; color: var(--gold);">
                <i class="fas fa-star"></i> Rate Staff
            </h2>

            <form id="review-form" onsubmit="submitReview(event)">
                <input type="hidden" id="review-job-id">
                <input type="hidden" id="review-staff-id">

                <div style="margin-bottom: 1.5rem;">
                    <h3 id="review-staff-name" style="color: var(--gold);"></h3>
                    <p id="review-job-title" style="color: var(--text-secondary);"></p>
                </div>

                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Overall Rating *</label>
                    <div class="rating-input" style="display: flex; gap: 0.5rem; font-size: 2rem;">
                        <span class="star" data-rating="1" onclick="setRating(1)">â˜†</span>
                        <span class="star" data-rating="2" onclick="setRating(2)">â˜†</span>
                        <span class="star" data-rating="3" onclick="setRating(3)">â˜†</span>
                        <span class="star" data-rating="4" onclick="setRating(4)">â˜†</span>
                        <span class="star" data-rating="5" onclick="setRating(5)">â˜†</span>
                    </div>
                    <input type="hidden" id="review-rating" required>
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Professionalism</label>
                    <input type="range" id="review-professionalism" min="1" max="5" value="5" style="width: 100%;"
                        oninput="updateRangeValue(this, 'prof-value')">
                    <span id="prof-value" style="color: var(--gold); font-weight: 600;">5/5</span>
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Punctuality</label>
                    <input type="range" id="review-punctuality" min="1" max="5" value="5" style="width: 100%;"
                        oninput="updateRangeValue(this, 'punct-value')">
                    <span id="punct-value" style="color: var(--gold); font-weight: 600;">5/5</span>
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Quality of Work</label>
                    <input type="range" id="review-quality" min="1" max="5" value="5" style="width: 100%;"
                        oninput="updateRangeValue(this, 'qual-value')">
                    <span id="qual-value" style="color: var(--gold); font-weight: 600;">5/5</span>
                </div>

                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Communication</label>
                    <input type="range" id="review-communication" min="1" max="5" value="5" style="width: 100%;"
                        oninput="updateRangeValue(this, 'qual-value')">
                    <span id="comm-value" style="color: var(--gold); font-weight: 600;">5/5</span>
                </div>

                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Comments (Optional)</label>
                    <textarea id="review-text" rows="4"
                        style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 8px;"
                        placeholder="Share your experience with this staff member..."></textarea>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn-outline" onclick="closeReviewModal()">Cancel</button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-paper-plane"></i> Submit Rating
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chat Modal (OLX-style) -->
    <div id="chat-modal" class="chat-modal" style="display: none;">
        <div class="chat-container">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-header-info">
                    <img id="chat-partner-avatar" src="" alt="User" class="chat-avatar">
                    <div>
                        <h3 id="chat-partner-name">User</h3>
                        <p id="chat-partner-status" class="chat-status">Online</p>
                    </div>
                </div>
                <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <button class="btn-outline btn-sm" onclick="goToMessagesSection()" title="Open in Messages Section"
                        style="padding: 0.5rem 1rem; font-size: 0.85rem;">
                        <i class="fas fa-external-link-alt"></i> Full Chat
                    </button>
                    <button class="chat-close-btn" onclick="closeChatModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Chat Messages -->
            <div id="chat-messages" class="chat-messages">
                <!-- Messages will be loaded here -->
            </div>

            <!-- Info Banner -->
            <div
                style="padding: 0.5rem 1rem; background: #f0f9ff; border-top: 1px solid #bfdbfe; font-size: 0.85rem; color: #1e40af; text-align: center;">
                <i class="fas fa-info-circle"></i> This conversation is saved. View it anytime in <a href="#messages"
                    onclick="goToMessagesSection()"
                    style="color: #2563eb; text-decoration: underline; cursor: pointer;">Messages Section</a>
            </div>

            <!-- Chat Input -->
            <div class="chat-input-container">
                <form id="chat-form" onsubmit="sendChatMessage(event)">
                    <input type="hidden" id="chat-partner-id" value="">
                    <textarea id="chat-message-input" placeholder="Type a message..." rows="1"
                        onkeydown="handleChatKeyPress(event)"></textarea>
                    <button type="submit" class="chat-send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="{% static 'js/script.js' %}?v=1.7"></script>
</body>

</html>